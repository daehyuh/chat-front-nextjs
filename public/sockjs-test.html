<!DOCTYPE html>
<html>
<head>
    <title>SockJS Direct Test</title>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.6.1/dist/sockjs.min.js"></script>
</head>
<body>
    <h1>SockJS Direct Connection Test</h1>
    <button onclick="connect()">Connect</button>
    <button onclick="disconnect()">Disconnect</button>
    <div id="log"></div>

    <script>
        let sock = null;
        
        function log(message) {
            const div = document.getElementById('log');
            div.innerHTML += '<p>' + new Date().toLocaleTimeString() + ' - ' + message + '</p>';
            console.log(message);
        }

        function connect() {
            log('Connecting to https://api.bob-dev.click/connect');
            
            sock = new SockJS('https://api.bob-dev.click/connect');
            
            sock.onopen = function() {
                log('‚úÖ Connection opened');
                // Try sending a STOMP CONNECT frame
                const connectFrame = "CONNECT\naccept-version:1.2,1.1,1.0\nheart-beat:10000,10000\n\n\0";
                log('Sending STOMP CONNECT frame');
                sock.send(connectFrame);
            };
            
            sock.onmessage = function(e) {
                log('üì® Message received: ' + e.data);
            };
            
            sock.onerror = function(e) {
                log('‚ùå Error: ' + JSON.stringify(e));
            };
            
            sock.onclose = function() {
                log('Connection closed');
            };
        }

        function disconnect() {
            if (sock) {
                sock.close();
                sock = null;
            }
        }
    </script>
</body>
</html>